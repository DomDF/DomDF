waic(x = log_lik_FAD_1)$elpd_waic,
waic(x = log_lik_FAD_2)$elpd_waic),
se = c(#waic(x = log_lik_BS7910_Option_1)$se_elpd_waic,
waic(x = log_lik_FAD_1)$se_elpd_waic,
waic(x = log_lik_FAD_2)$se_elpd_waic))
log_lik_FAD_1 <- loo::extract_log_lik(stanfit = FAD_bayes, parameter_name = 'loglik')
log_lik_FAD_2 <- loo::extract_log_lik(stanfit = GP_FAD, parameter_name = 'loglik')
log_lik_FAD_1 <- loo::extract_log_lik(stanfit = FAD_Bayes_fit, parameter_name = 'loglik')
log_lik_FAD_2 <- loo::extract_log_lik(stanfit = GP_FAD_fit, parameter_name = 'loglik')
ID_df <- GP_FAD_samples %>% dplyr::filter(grepl(pattern = '_data_pp', x = Parameter)) %>%
# dplyr::arrange(Parameter) %>%
mutate(Lr_pp = rep(x = test_data$Lr,
each = nChains * iterations),
ID = rep(x = test_data$ID,
each = nChains * iterations))
ID_df <- GP_FAD_samples %>% dplyr::filter(grepl(pattern = '_data_pp', x = Parameter))
ID_df
GP_FAD_data
rstan:::rstudio_stanc("~/PhD/FAD/GP_FAD.stan")
rstan:::rstudio_stanc("~/PhD/FAD/GP_FAD.stan")
rstan:::rstudio_stanc("~/PhD/FAD/GP_fit.stan")
GP_FAD_data <- list(N1 = nrow(test_data), x1 = test_data$Lr, y1 = test_data$Kr,
N2 = nrow(test_data), x2 = test_data$Lr,
rho_rate = 2, alpha_rate = 1, sigma_rate = 1)
GP_FAD_model <- cmdstanr::cmdstan_model(stan_file = '~/PhD/FAD/GP_fit.stan')
GP_FAD_fit <- GP_FAD_model$sample(data = GP_FAD_data, seed = 1008,
chains = n_chains, parallel_chains = parallel::detectCores(),
iter_warmup = n_wu, iter_sampling = n_draws, thin = 1,
adapt_delta = 0.9)
GP_FAD_samples <- DomDF::tidy_mcmc_draws(cmdstan_fit = GP_FAD_fit, params = params_to_extract)
GP_params <- GP_FAD_fit$metadata()$model_params
params_to_extract <- GP_params[!grepl(x = GP_params, pattern = 'K.|lp__|eta')]
params_to_extract
GP_FAD_samples <- DomDF::tidy_mcmc_draws(cmdstan_fit = GP_FAD_fit, params = params_to_extract)
GP_FAD_samples %>% dplyr::filter(grepl(pattern = 'y2', x = Parameter))
ID_df <- GP_FAD_samples %>% dplyr::filter(grepl(pattern = 'y2', x = Parameter)) %>%
# dplyr::arrange(Parameter) %>%
mutate(Lr_pp = rep(x = test_data$Lr,
each = nChains * iterations),
ID = rep(x = test_data$ID,
each = nChains * iterations))
ID_df <- GP_FAD_samples %>% dplyr::filter(grepl(pattern = 'y2', x = Parameter)) %>%
# dplyr::arrange(Parameter) %>%
mutate(Lr_pp = rep(x = test_data$Lr,
each = n_chains * n_draws),
ID = rep(x = test_data$ID,
each = n_chains * n_draws))
PoF_labels <- test_data %>% select(ID)
for (i in seq(from = 1, to = nrow(PoF_labels), by = 1)){
PoF_labels$PoF[i] <- nrow(ID_df %>%
dplyr::filter(ID == PoF_labels$ID[i]) %>%
dplyr::filter(value <= (test_data %>%
dplyr::filter(ID == PoF_labels$ID[i]))$Kr)) /
nrow(ID_df %>%
dplyr::filter(ID == PoF_labels$ID[i]))
}
PoF_labels
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Kr[Model]'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Kr[Data]'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(extrafont)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Kr[Model]'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Kr[Data]'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::loadfonts()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Kr[Model]'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Kr[Data]'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::loadfonts(device = 'win')
extrafont::fonts()
library(extrafont)
library(extrafontdb)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Kr[Model]'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Kr[Data]'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = expression(Kr[Model])),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Kr[Data]'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(extrafont)
extrafont::font_install()
extrafont::font_install(fontpkg = 'Cambria')
extrafont::font_import()
library(extrafont)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::loadfonts()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::loadfonts(device = 'win', quiet = TRUE)
warnings()
extrafont::loadfonts(device = 'win', quiet = TRUE)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
font_import(pattern = 'Cambria')
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria Math')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria Math')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
warnings()
loadfonts()
fonts()
font_import()
fonts()
loadfonts()
install.packages("extrafontdb")
install.packages("extrafontdb")
install.packages("extrafontdb")
extrafont::loadfonts()
extrafont::loadfonts()
install.packages("extrafontdb")
extrafont::loadfonts()
library(extrafont)
loadfonts()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(tidyverse)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::choose_font(fonts = 'Cambria')
extrafont::choose_font(fonts = 'Cambria Math')
extrafont::choose_font(fonts = "Cambria Math")
extrafont::choose_font(fonts = "Cambria")
extrafont::fonts()
extrafont::loadfonts()
extrafont::font_install()
extrafont::font_import()
extrafont::loadfonts()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.5,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(extrafont)
loadfonts()
fonts()
install.packages('extrafont')
install.packages("extrafont")
detach("package:extrafont", unload = TRUE)
install.packages("extrafont")
library(extrafont)
font_import()
showtext::showtext_auto()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(extrafont)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::loadfonts()
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 3.0, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
extrafont::font_import()
library(extrafont)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 2.5, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
showtext::showtext.auto()
library(extrafont)
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 2.5, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
library(tidyverse); library(extrafont)
ID_df
ggplot(data = ID_df,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = value))+
geom_density(mapping = aes(y = ..density.., fill = 'Predicted Kr'),
alpha = 0.2, size = 1/4)+
scale_fill_manual(values = c('grey20'))+
geom_vline(data = test_data,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(xintercept = Kr, lty = 'Observed Kr'),
alpha = 0.4)+
scale_linetype_manual(values = c(2))+
geom_text(data = PoF_labels,# %>% mutate(ID = paste('ID', ID)),
mapping = aes(x = 2.5, y = 1.2,
label = paste('PoF = ',
signif(x = PoF,
digits = 3))),
size = 3, family = 'Cambria')+
facet_wrap(facets = ~ ID)+
scale_x_continuous(name = 'Kr', breaks = scales::pretty_breaks(), limits = c(0, 4))+
scale_y_continuous(name = 'Posterior likelihood', limits = c(0, 1.6),
breaks = seq(from = 0, to = 1.2, by = 0.4))+
ggthemes::theme_base(base_size = 12, base_family = 'Cambria')+
theme(legend.position = 'top', legend.title = element_blank(),
plot.background = element_rect(colour = NA))
